<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="author" content="geckronome" />
    <link rel="stylesheet" href="/styles/main.min.css" />
    <link rel="icon" href="/img/icon.png" type="image/png" />
    <link rel="stylesheet" href="/styles/syntax_highlighting.min.css" />
    <meta charset="utf-8" />
    <meta name="description" content="this is a personal windows 11 setup guide" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta property="og:description" content="this is a personal windows 11 setup guide" />
    <meta property="og:title" content="geck's site - windows 11" />
    <meta property="og:type" content="article" />
    <script src="/js/highlight.min.js"></script>
    <title>geck - w11 setup</title>
  </head>

  <body>
    <header>
      <h1>Windows 11 Setup</h1>
      <nav>
        <ul>
          <li id="homepage-link"><a href="/index.html">Back to homepage...</a></li>
          <li id="date">Last updated: <time id="date-last-updated" datetime="2024-07-02"></time></li>
        </ul>
      </nav>
    </header>
    <main>
      <article>
        <h2><a href="#pre-requisites">Pre-requisites</a></h2>

        <ul>
          <li>Just have a computer capable of TPM and Secure Boot and all of that stuff</li>
          <li>An en_US <a href="https://www.microsoft.com/software-download/windows11">Windows 11 ISO</a> (Latest as of writing is <code>23H2x64_v2</code>)</li>
          <li>A working internet connection. No matter what, you will send information to Microsoft. You <i>shouldn't</i> need it for installing the OS, but it's best to have it anyway.</li>
        </ul>

        <h2><a href="#installation">Installation</a></h2>

        <ol>
          <li>Set your <i>Language and Time</i> and <i>Currency</i> settings.</li>
          <li>Install the <b>Windows 11 Pro</b> version.</li>
          <ul>
            <li>If you for some reason have a mega CPU like a Xeon or Epyc, then use <i>Pro for Workstations</i>.</li>
          </ul>
          <li>Follow through all the prompts as you need.</li>
          <li>When getting to the Microsoft sign-in prompt, enter <code>fake@fake.com</code> in the email section and type a random password to unlock local accounts.</li>
          <ul>
            <li>Sometimes you will need to enter the email/password, and then restart the PC and enter it again for local accounts to show up.</li>
            <li>If you do not have internet, press <code>Shift+F10</code> to open cmd and paste <code>OOBE\BYPASSNRO</code>, then the <b>I don't have internet</b> should become visible.</li>
          </ul>
          <li>
            At this point you should see the Windows background. Go straight to Windows Update and
            <b>update your system</b>. This includes all optional updates in advanced settings>optional settings.
          </li>
        </ol>

        <h2><a href="#disable-telemetry">Disable telemetry and always-online features</a></h2>

        <p>Update 2024-07-02: I'm going to be honest, Windows 11's updates have been very good in minimizing the amount of default overhead and this isn't extremely needed anymore. Still, if there's something here that seems interesting, use it.</p>
        <p>
          <i
            >Tweaks researched by myself, and some cherrypicked from <a href="https://github.com/ChrisTitusTech/winutil">winutil</a>, <a href="https://github.com/farag2/Sophia-Script-for-Windows">Sophia script</a> and
            <a href="https://github.com/simeononsecurity/Windows-Optimize-Harden-Debloat/tree/master">simeononsecurity</a>.</i
          >
        </p>

        <p>Take the following code and dump it into a <code>.ps1</code> file and then run it as Administrator, and it should work! <b>I am not responsible for anything that goes wrong</b>, please look over what you copy and paste.</p>
        <p><i>Note: you will still need to manually turn off Activity history.</i></p>

        <pre class="powershell"><code># Do not let apps show me personalized ads by using my advertising ID
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\AdvertisingInfo" /v "Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\CPSS\Store\AdvertisingInfo" /v "Value" /t REG_DWORD /d 0 /f

# Do not let websites show me locally relevant content
reg add "HKCU\Control Panel\International\User Profile" /v "HttpAcceptLanguageOptOut" /t REG_DWORD /d 1 /f

# Do not let Windows improve Start and search results
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_TrackProgs" /t REG_DWORD /d 0 /f

# Don't show recommendations for new apps
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_IrisRecommendations" /t REG_DWORD /d 0 /f

# Do not let Windows show your browsing history in Search
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_RecoPersonalizedSites" /t REG_DWORD /d 0 /f

# Do not show suggested content in the Settings app
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "ContentDeliveryAllowed" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "FeatureManagementEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "OemPreInstalledAppsEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "PreInstalledAppsEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "PreInstalledAppsEverEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SilentInstalledAppsEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-310093Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-314559Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338387Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338388Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338389Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338393Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353694Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353696Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContentEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SystemPaneSuggestionsEnabled" /t REG_DWORD /d 0 /f

# Do not show notifications in the Settings app
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\SystemSettings\AccountNotifications" /v "EnableAccountNotifications" /t REG_DWORD /d 0 /f

# Do not ask me ways to get the most out of Windows
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\UserProfileEngagement" /v "ScoobeSystemSettingEnabled" /t REG_DWORD /d 0 /f

# Disable online speech recognition
reg add "HKCU\Software\Microsoft\Speech_OneCore\Settings\OnlineSpeechPrivacy" /v "HasAccepted" /t REG_DWORD /d 0 /f

# Do not send inking and typing personalization
reg add "HKCU\Software\Microsoft\InputPersonalization" /v "RestrictImplicitTextCollection" /t REG_DWORD /d 1 /f
reg add "HKCU\Software\Microsoft\InputPersonalization" /v "RestrictImplicitInkCollection" /t REG_DWORD /d 1 /f
reg add "HKCU\Software\Microsoft\InputPersonalization\TrainedDataStore" /v "HarvestContacts" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Personalization\Settings" /v "AcceptedPrivacyPolicy" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\InputPersonalization\TrainedDataStore" /v "HarvestContacts" /t REG_DWORD /d 0 /f

# Do not send optional diagnostic data
# \/ You can set this *ONE* setting to 0 if you use *Enterprise* or *Education* editions of Windows. If not, leave it as 1
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection" /v "AllowTelemetry" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection" /v "MaxTelemetryAllowed" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v "AllowTelemetry" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v "DoNotShowFeedbackNotifications" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CPSS\Store\AllowTelemetry" /v "Value" /t REG_DWORD /d 1 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Diagnostics\DiagTrack" /v "ShowedToastAtLevel" /t REG_DWORD /d 1 /f

# Do not let MS use your diagnostic data for personalized tips/ads
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Privacy" /v "TailoredExperiencesWithDiagnosticDataEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\CPSS\Store\TailoredExperiencesWithDiagnosticDataEnabled" /v "Value" /t REG_DWORD /d 0 /f

# Do not ask for feedback
reg add "HKCU\Software\Microsoft\Siuf\Rules" /v "NumberOfSIUFInPeriod" /t REG_DWORD /d 0 /f

# Do not use cloud content search
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\SearchSettings" /v "IsMSACloudSearchEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\SearchSettings" /v "IsAADCloudSearchEnabled" /t REG_DWORD /d 0 /f

# Disable search history
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\SearchSettings" /v "IsDeviceSearchHistoryEnabled" /t REG_DWORD /d 0 /f

# Disable search highlights and suggestions
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\SearchSettings" /v "IsDynamicSearchBoxEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Policies\Microsoft\Windows\Explorer" /v "DisableSearchBoxSuggestions" /t REG_DWORD /d 1 /f

# Do not communicate with unpaired devices
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\bluetoothSync" /v "Value" /t REG_SZ /d "Deny" /f

# Disable application access to... (will break UWP app functionality)
# app diagnostics
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appDiagnostics" /v "Value" /t REG_SZ /d "Deny" /f
reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appDiagnostics" /v "Value" /t REG_SZ /d "Deny" /f
# call history
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\phoneCallHistory" /v "Value" /t REG_SZ /d "Deny" /f
reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\phoneCallHistory" /v "Value" /t REG_SZ /d "Deny" /f
# contacts
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\contacts" /v "Value" /t REG_SZ /d "Deny" /f
reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\contacts" /v "Value" /t REG_SZ /d "Deny" /f
# radios
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\radios" /v "Value" /t REG_SZ /d "Deny" /f
reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\radios" /v "Value" /t REG_SZ /d "Deny" /f
# messaging
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\chat" /v "Value" /t REG_SZ /d "Deny" /f
reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\chat" /v "Value" /t REG_SZ /d "Deny" /f
# tasks
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userDataTasks" /v "Value" /t REG_SZ /d "Deny" /f
reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userDataTasks" /v "Value" /t REG_SZ /d "Deny" /f
# account info
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userAccountInformation" /v "Value" /t REG_SZ /d "Deny" /f
reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userAccountInformation" /v "Value" /t REG_SZ /d "Deny" /f
# camera
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\webcam" /v "Value" /t REG_SZ /d "Deny" /f
reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\webcam" /v "Value" /t REG_SZ /d "Deny" /f
# calendar
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appointments" /v "Value" /t REG_SZ /d "Deny" /f
reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appointments" /v "Value" /t REG_SZ /d "Deny" /f
# phone calls
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\phoneCall" /v "Value" /t REG_SZ /d "Deny" /f
reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\phoneCall" /v "Value" /t REG_SZ /d "Deny" /f

# Disable auto-updating of maps (will harm Windows Maps)
reg add "HKLM\SYSTEM\Maps" /v "AutoUpdateEnabled" /t REG_DWORD /d 0 /f

# Disable recently used files, folders, and files from Office.com
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v "ShowRecent" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v "ShowFrequent" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v "ShowCloudFilesInQuickAccess" /t REG_DWORD /d 0 /f

# Disable cloud content
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsConsumerFeatures" /t REG_DWORD /d 1 /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsConsumerFeatures" /t REG_DWORD /d 1 /f

# Disable windows error reporting
reg add "HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "Disabled" /t REG_DWORD /d 1 /f
## Defense-in-depth
#Set-Service -Name WerSvc -StartupType Disabled

# Disable Wi-Fi Sense
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\default\WiFi\AllowWiFiHotSpotReporting" /v "Value" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\default\WiFi\AllowAutoConnectToWiFiSenseHotspots" /v "Value" /t REG_DWORD /d 0 /f

# Disable people features
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\People" /v "PeopleBand" /t REG_DWORD /d 0 /f

# Turn off MS office telemetry (May break some Office features)
reg add "HKCU\SOFTWARE\Microsoft\Office\Common\ClientTelemetry" /v "DisableTelemetry" /t REG_DWORD /d 1 /f
reg add "HKCU\SOFTWARE\Microsoft\Office\Common\ClientTelemetry" /v "VerboseLogging" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Office\16.0\Common\ClientTelemetry" /v "DisableTelemetry" /t REG_DWORD /d 1 /f
reg add "HKCU\SOFTWARE\Microsoft\Office\16.0\Common\ClientTelemetry" /v "VerboseLogging" /t REG_DWORD /d 0 /f

# Some other ones to consider (but not recommended)

## Turn off automatic app updating in the MS Store
#reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsStore\WindowsUpdate" /v "AutoDownload" /t REG_DWORD /d 2 /f
</code></pre>

        <h2><a href="#disable-features">Disable un-needed features (performance)</a></h2>

        <p>You will need to turn off all startup apps, but you should keep <i>Windows Security</i> enabled.</p>
        <pre><code class="powershell"># Disable typing insights
reg add "HKCU\Software\Microsoft\input\Settings" /v "InsightsEnabled" /t REG_DWORD /d 0 /f

# Disable storage sense
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\StorageSense\Parameters\StoragePolicy" /v "01" /t REG_DWORD /d 0 /f
## Disable storage sense automatically cleaning temporary files
#reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\StorageSense\Parameters\StoragePolicy" /v "04" /t REG_DWORD /d 0 /f

# Don't show Edge tabs with Alt+Tab
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "MultiTaskingAltTabFilter" /t REG_DWORD /d 3 /f

# Don't show snapped groups windows in Alt+tab
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "EnableTaskGroups" /t REG_DWORD /d 0 /f

# Don't show snap layouts at the top of the screen
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "EnableSnapBar" /t REG_DWORD /d 0 /f

# Remove copilot, task view and widgets from taskbar
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowCopilotButton" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowTaskViewButton" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarDa" /t REG_DWORD /d 0 /f

# Disable copilot and make current user ineligible to use it (could break things in the future)
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsCopilot" /v "TurnOffWindowsCopilot" /t REG_DWORD /d 1 /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\WindowsCopilot" /v "TurnOffWindowsCopilot" /t REG_DWORD /d 1 /f
reg add "HKCU\Software\Microsoft\Windows\Shell\Copilot\BingChat" /v "IsUserEligible" /t REG_DWORD /d 0 /f

# Turn off auto installation of Microsoft Teams in the taskbar
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Communications" /v "ConfigureChatAutoInstall" /t REG_DWORD /d 0 /f

# Turn off search box (0 = hidden, 1 = icon, 2 = Box, 3 = Icon with label)
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Search" /v "SearchboxTaskbarMode" /t REG_DWORD /d 0 /f

## Set taskbar to left (i don't use this, but here is the registry entry)
#reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarAl" /t REG_DWORD /d 0 /f

# Turn off lock screen notifications
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\PushNotifications" /v "LockScreenToastEnabled" /t REG_DWORD /d 0 /f

# Turn off reminders and calls on the lock screen
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Notifications\Settings" /v "NOC_GLOBAL_SETTING_ALLOW_CRITICAL_TOASTS_ABOVE_LOCK" /t REG_DWORD /d 0 /f

# Don't run any troubleshooters
reg add "HKLM\SOFTWARE\Microsoft\WindowsMitigation" /v "UserPreference" /t REG_DWORD /d 1 /f

# Disable autocorrection of misspelled words
reg add "HKCU\Software\Microsoft\TabletTip\1.7" /v "EnableAutocorrection" /t REG_DWORD /d 0 /f

# Disable game bar opening with controller
reg add "HKCU\Software\Microsoft\GameBar" /v "UseNexusForGameBarEnabled" /t REG_DWORD /d 0 /f

# Disable sticky and filter keys
reg add "HKCU\Control Panel\Accessibility\StickyKeys" /v "Flags" /t REG_SZ /d "506" /f
reg add "HKCU\Control Panel\Accessibility\Keyboard Response" /v "Flags" /t REG_SZ /d "122" /f

# Disable SafeSearch in search box
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\SearchSettings" /v "SafeSearchMode" /t REG_DWORD /d 0 /f

# Disable delivery optimization (Useful if there is a lot of computers on your network, don't disable if that is the case)
reg add "HKEY_USERS\S-1-5-20\Software\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Settings" /v "DownloadMode" /t REG_DWORD /d 0 /f # S-1-5-20 is NetworkService
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Config" /v "DODownloadMode" /t REG_DWORD /d 0 /f

Delete-DeliveryOptimizationCache -Force

# Disable Remote Assistance
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Remote Assistance" /v "fAllowToGetHelp" /t REG_DWORD /d 0 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Remote Assistance" /v "fAllowFullControl" /t REG_DWORD /d 0 /f

# Disable any remote file access (will break remote software)
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LanmanSever\Parameters" /v "AutoShareWks" /t REG_DWORD /d 0 /f

# Disable windows managing the default printer
reg add "HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows" /v "LegacyDefaultPrinterMode" /t REG_DWORD /d 1 /f

# Disable bing search results entirely in Search
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Search" /v "BingSearchEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Search" /v "CortanaConsent" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\Search" /v "BingSearchEnabled" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\Search" /v "CortanaConsent" /t REG_DWORD /d 0 /f

# Turn off sign-in info to automatically finish setting up device (From Sophia script)
$SID = (Get-CimInstance -ClassName Win32_UserAccount | Where-Object -FilterScript {$_.Name -eq $env:USERNAME}).SID
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\UserARSO\$SID" /v "OptOut" /t REG_DWORD /d 1 /f

# Disable feeds (w10 only)
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\Windows Feeds" /v "EnableFeeds" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Feeds" /v "ShellFeedsTaskbarViewMode" /t REG_DWORD /d 2 /f

# Disable meet now (w10 only)
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "HideSCAMeetNow" /t REG_DWORD /d 1 /f

# Disable 260 character Path limit
reg add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v "LongPathsEnabled" /t REG_DWORD /d 1 /f

# Some other ones to consider (but not recommended)

# Turn off and lock various parts of the Edge browser
# Note: You CANNOT remove Edge without Windows shitting itself
## Disable prelaunch on system startup
#reg add "HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Main" /v "AllowPreLaunch" /t REG_DWORD /d 0 /f
## Third-party cookies are the only ones allowed
#reg add "HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Main" /v "Cookies" /t REG_DWORD /d 1 /f
## Prevent Edge from gathering live tile information
#reg add "HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Main" /v "PreventLiveTileDataCollection" /t REG_DWORD /d 1 /f
## Disable MS sync
#reg add "HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Main" /v "SyncDisabled" /t REG_DWORD /d 1 /f
## Disable credit card autofill
#reg add "HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Main" /v "AutofillCreditCardEnabled" /t REG_DWORD /d 1 /f
## Disable flash player support
#reg add "HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Addons" /v "FlashPlayerEnabled" /t REG_DWORD /d 0 /f
## Don't allow web content on start screen
#reg add "HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\ServiceUI" /v "AllowWebContent" /t REG_DWORD /d 0 /f
## Don't preload tabs
#reg add "HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\TabPreloader" /v "AllowTabPreloading" /t REG_DWORD /d 0 /f
</code></pre>

        <h2><a href="#enable-features">Enable nice features</a></h2>

        <p>You will need to manually turn on Night light, Enhanced search and the power mode.</p>

        <pre class="powershell"><code># Turn on Developer mode
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\AppModelUnlock" /v "AllowDevelopmentWithoutDevLicense" /t REG_DWORD /d 1 /f

# Turn on End task in taskbar
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\TaskbarDeveloperSettings" /v "TaskbarEndTask" /t REG_DWORD /d 1 /f

# Turn ON clipboard history (Win+V)
reg add "HKCU\Software\Microsoft\Clipboard" /v "EnableClipboardHistory" /t REG_DWORD /d 1 /f

# Receive updates for other MS products in Windows Update
reg add "HKLM\SOFTWARE\Microsoft\WindowsUpdate\UX\Settings" /v "AllowMUUpdateService" /t REG_DWORD /d 1 /f

## Receive non-security updates as soon as possible
#reg add "HKLM\SOFTWARE\Microsoft\WindowsUpdate\UX\Settings" /v "IsContinuousInnovationOptedIn" /t REG_DWORD /d 1 /f

# Display full path in Explorer title bar
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\CabinetState" /v "FullPath" /t REG_DWORD /d 1 /f

# Show hidden files/folders/drives in Explorer
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Hidden" /t REG_DWORD /d 1 /f

# Do not hide empty drives
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "HideDrivesWithNoMedia" /t REG_DWORD /d 0 /f
# Show file extensions
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "HideFileExt" /t REG_DWORD /d 0 /f
# Show merge conflicts
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "HideMergeConflicts" /t REG_DWORD /d 0 /f
# Show encrypted/compressed NTFS in color
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowEncryptCompressedColor" /t REG_DWORD /d 1 /f
# Open to This PC instead (Quick Access is LaunchTo = 2)
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "LaunchTo" /t REG_DWORD /d 1 /f
# Disable Sync provider notifications (OneDrive ads)
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowSyncProviderNotifications" /t REG_DWORD /d 0 /f
# Disable check boxes (seems to be a default now)
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "AutoCheckSelect" /t REG_DWORD /d 0 /f
# Set explorer operation/status to detailed
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\OperationStatusManager" /v "EnthusiastMode" /t REG_DWORD /d 1 /f
## Compact mode
#reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "UseCompactMode" /t REG_DWORD /d 1 /f

# Disable F1 help on some MS apps
reg add "HKCU\Software\Classes\Typelib\{8cec5860-07a1-11d9-b15e-000d56bfe6ee}\1.0\0\win64" /v "(default)" /t REG_SZ /d "" /f

# Enable NUM lock at start-up
reg add "HKEY_USERS\.DEFAULT\Control Panel\Keyboard" /v "InitialKeyboardIndicators" /t REG_SZ /d 2147483650 /f

# Enable verbose log-on messages
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "VerboseStatus" /t REG_DWORD /d 1 /f

# Enable BSoD messages
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl" /v "DisplayParameters" /t REG_DWORD /d 1 /f

# Turn on Network Discovery for your private network (From Sophia script)
$FirewallRules = @(
  # File and printer sharing
  "@FirewallAPI.dll,-32752",

  # Network discovery
  "@FirewallAPI.dll,-28502"
)
Set-NetFirewallRule -Group $FirewallRules -Profile Private -Enabled True
Set-NetFirewallRule -Profile Public, Private -Name FPS-SMB-In-TCP -Enabled True
Set-NetConnectionProfile -NetworkCategory Private

# Set Control Panel from Category view to Large icons view
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ControlPanel" /v "AllItemsIconView" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ControlPanel" /v "StartupPage" /t REG_DWORD /d 1 /f

# Fix JPEG wallpapers
reg add "HKCU\Control Panel\Desktop" /v "JPEGImportQuality" /t REG_DWORD /d 100 /f

# Fix the download folder grouping to stop already (From Sophia script)
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FolderTypes\{885a186e-a440-4ada-812b-db871b942259}\TopViews\{00000000-0000-0000-0000-000000000000}" /v "ColumnList" /t REG_SZ /d "System.Null" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FolderTypes\{885a186e-a440-4ada-812b-db871b942259}\TopViews\{00000000-0000-0000-0000-000000000000}" /v "GroupBy" /t REG_SZ /d "System.Null" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FolderTypes\{885a186e-a440-4ada-812b-db871b942259}\TopViews\{00000000-0000-0000-0000-000000000000}" /v "LogicalViewMode" /t REG_DWORD /d 1 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FolderTypes\{885a186e-a440-4ada-812b-db871b942259}\TopViews\{00000000-0000-0000-0000-000000000000}" /v "Name" /t REG_SZ /d "NoName" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FolderTypes\{885a186e-a440-4ada-812b-db871b942259}\TopViews\{00000000-0000-0000-0000-000000000000}" /v "Order" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FolderTypes\{885a186e-a440-4ada-812b-db871b942259}\TopViews\{00000000-0000-0000-0000-000000000000}" /v "PrimaryProperty" /t REG_SZ /d "System.ItemNameDisplay" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FolderTypes\{885a186e-a440-4ada-812b-db871b942259}\TopViews\{00000000-0000-0000-0000-000000000000}" /v "SortByList" /t REG_SZ /d "System.ItemNameDisplay" /f
</code></pre>

        <h2><a href="#uninstall-default-applications">Uninstall default apps</a></h2>

        <p>I keep Notepad, Paint, the MS Store, all video/image extensions, Photos, Camera, Calculator, Clock, Snipping Tool, Sticky Notes, Terminal and all the Xbox stuff.</p>
        <p>You will need to uninstall OneDrive separately, or make it not auto-backup your folders.</p>

        <pre><code class="powershell">Get-AppxPackage "Clipchamp.Clipchamp" | Remove-AppxPackage
Get-AppxPackage "*Microsoft.Advertising.Xaml*" | Remove-AppxPackage
Get-AppxPackage "*Spotify*" | Remove-AppxPackage
Get-AppxPackage "*MicrosoftTeams*" | Remove-AppxPackage
Get-AppxPackage "*Disney*" | Remove-AppxPackage
Get-AppxPackage "Microsoft.549981C3F5F10" | Remove-AppxPackage # Cortana
Get-AppxPackage "Microsoft.BingFinance" | Remove-AppxPackage
Get-AppxPackage "Microsoft.BingFoodAndDrink" | Remove-AppxPackage
Get-AppxPackage "Microsoft.BingHealthAndFitness" | Remove-AppxPackage
Get-AppxPackage "Microsoft.BingNews" | Remove-AppxPackage
Get-AppxPackage "Microsoft.BingSports" | Remove-AppxPackage
Get-AppxPackage "Microsoft.BingTranslator" | Remove-AppxPackage
Get-AppxPackage "Microsoft.BingTravel" | Remove-AppxPackage
Get-AppxPackage "Microsoft.BingWeather" | Remove-AppxPackage
Get-AppxPackage "Microsoft.GetHelp" | Remove-AppxPackage
Get-AppxPackage "Microsoft.Getstarted" | Remove-AppxPackage
Get-AppxPackage "Microsoft.MicrosoftOfficeHub" | Remove-AppxPackage # You can install actual 365 anyway
Get-AppxPackage "Microsoft.MicrosoftSolitaireCollection" | Remove-AppxPackage
Get-AppxPackage "Microsoft.MixedReality.Portal" | Remove-AppxPackage
Get-AppxPackage "Microsoft.News" | Remove-AppxPackage
Get-AppxPackage "Microsoft.Office.OneNote" | Remove-AppxPackage
Get-AppxPackage "Microsoft.OutlookForWindows" | Remove-AppxPackage
Get-AppxPackage "Microsoft.People" | Remove-AppxPackage
Get-AppxPackage "Microsoft.PowerAutomateDesktop" | Remove-AppxPackage
Get-AppxPackage "Microsoft.Print3D" | Remove-AppxPackage
Get-AppxPackage "Microsoft.SkypeApp" | Remove-AppxPackage
Get-AppxPackage "Microsoft.Todos" | Remove-AppxPackage
Get-AppxPackage "Microsoft.Wallet" | Remove-AppxPackage
Get-AppxPackage "Microsoft.Windows.Ai.Copilot.Provider" | Remove-AppxPackage
Get-AppxPackage "Microsoft.Windows.ParentalControls" | Remove-AppxPackage
Get-AppxPackage "microsoft.windowscommunicationsapps" | Remove-AppxPackage # Calendar and Mail
Get-AppxPackage "Microsoft.WindowsFeedbackHub" | Remove-AppxPackage
Get-AppxPackage "Microsoft.WindowsMaps" | Remove-AppxPackage
Get-AppxPackage "Microsoft.WindowsPhone" | Remove-AppxPackage
Get-AppxPackage "Microsoft.WindowsSoundRecorder" | Remove-AppxPackage
Get-AppxPackage "Microsoft.YourPhone" | Remove-AppxPackage # Phone Link
Get-AppxPackage "Microsoft.ZuneMusic" | Remove-AppxPackage # Groove Music
Get-AppxPackage "Microsoft.ZuneVideo" | Remove-AppxPackage # Films & TV
Get-AppxPackage "MicrosoftCorporationII.QuickAssist" | Remove-AppxPackage
</code></pre>

        <h2><a href="#other-pwsh-tweaks">Other Powershell tweaks</a></h2>

        <pre><code class="powershell"># Disable hibernation
powercfg.exe /hibernate off

# Disable homegroup (Shouldn't be here on Windows 11 but still good to check)
Set-Service -Name HomeGroupListener -StartupType Manual
Set-Service -Name HomeGroupProvider -StartupType Manual

# Turn various services to manual, and also disable some services
Stop-Service -Name AJRouter -Force
Set-Service -Name AJRouter -StartupType Disabled
Stop-Service -Name AssignedAccessManagerSvc -Force
Set-Service -Name AssignedAccessManagerSvc -StartupType Disabled # Kiosk mode
Set-Service -Name CDPSvc -StartupType Manual
Stop-Service -Name diagnosticshub.standardcollector.service -Force
Set-Service -Name diagnosticshub.standardcollector.service -StartupType Disabled

# Leave enabled if you use Xbox app and Feedback Hub, some core Windows applications depend on this service.
Stop-Service -Name DiagTrack -Force
Set-Service -Name DiagTrack -StartupType Disabled
# Defense in-depth
##Set-NetFirewallRule -Group DiagTrack -Enabled True -Action Block

Set-Service -Name EdgeUpdate -StartupType Manual
Set-Service -Name MapsBroker -StartupType Manual # Will break maps
Set-Service -Name PcaSvc -StartupType Manual # Program Compatibility Assistant
Stop-Service -Name RemoteRegistry -Force
Set-Service -Name RemoteRegistry -StartupType Disabled # Disabled by default, just in case
Set-Service -Name StateRepository -StartupType Manual
Set-Service -Name StorSvc -StartupType Manual
Set-Service -Name TextInputManagementService -StartupType Manual
Set-Service -Name UsoSvc -StartupType Manual # May cause issues with windows update, shouldn't though
Set-Service -Name vm3dservice -StartupType Manual # for VMWare
Set-Service -Name wisvc -StartupType Disabled # Disables Windows Insider
Set-Service -Name WpnService -StartupType Manual

## Disable un-needed scheduled tasks (Will break some things)

# Comment out if you use Microsoft Family Safety
Get-ScheduledTask -TaskName "FamilySafetyMonitor" | Disable-ScheduledTask
Get-ScheduledTask -TaskName "FamilySafetyRefreshTask" | Disable-ScheduledTask
# Comment out if you use Microsoft Maps
Get-ScheduledTask -TaskName "MapsToastTask" | Disable-ScheduledTask
Get-ScheduledTask -TaskName "MapsUpdateTask" | Disable-ScheduledTask
# Comment out if you use Xbox
Get-ScheduledTask -TaskName "XblGameSaveTask" | Disable-ScheduledTask

Get-ScheduledTask -TaskName "AitAgent" | Disable-ScheduledTask
Get-ScheduledTask -TaskName "Consolidator" | Disable-ScheduledTask # Telemetry
Get-ScheduledTask -TaskName "Device User" | Disable-ScheduledTask
Get-ScheduledTask -TaskName "Device" | Disable-ScheduledTask
Get-ScheduledTask -TaskName "DmClient" | Disable-ScheduledTask
Get-ScheduledTask -TaskName "DmClientOnScenarioDownload " | Disable-ScheduledTask
Get-ScheduledTask -TaskName "KernelCeipTask" | Disable-ScheduledTask
Get-ScheduledTask -TaskName "MareBackup" | Disable-ScheduledTask # Telemetry
Get-ScheduledTask -TaskName "Microsoft Compatibility Appraiser" | Disable-ScheduledTask # Telemetry
Get-ScheduledTask -TaskName "OfficeTelemetryAgentFallBack2016" | Disable-ScheduledTask
Get-ScheduledTask -TaskName "OfficeTelemetryAgentLogOn2016" | Disable-ScheduledTask
Get-ScheduledTask -TaskName "ProgramDataUpdater" | Disable-ScheduledTask
Get-ScheduledTask -TaskName "Proxy" | Disable-ScheduledTask # Telemetry
Get-ScheduledTask -TaskName "QueueReporting" | Disable-ScheduledTask # Error reporting
Get-ScheduledTask -TaskName "StartupAppTask" | Disable-ScheduledTask # Checks what startup apps you have on log-in and recommends to disable
Get-ScheduledTask -TaskName "UsbCeip" | Disable-ScheduledTask # Telemetry about your USB devices
Get-ScheduledTask -TaskName "Microsoft-Windows-DiskDiagnosticDataCollector" | Disable-ScheduledTask # Telemetry

# Disable SMBv1
Disable-WindowsOptionalFeature -Online -NoRestart -FeatureName SMB1Protocol
dism /Online /Disable-Feature /FeatureName:"SMB1Protocol-Client" /NoRestart
dism /Online /Disable-Feature /FeatureName:"SMB1Protocol-Server" /NoRestart

# Disable XPS Document Writer
Disable-WindowsOptionalFeature -Online -NoRestart -FeatureName Printing-XPSServices-Features

# Disable Work folders for Windows Server (Do not turn this off if you are connected to AD)
Disable-WindowsOptionalFeature -Online -NoRestart -FeatureName WorkFolders-Client

# Disable PowerShell 2.0
dism /online /Disable-Feature /FeatureName:"MicrosoftWindowsPowerShellV2Root" /NoRestart
dism /online /Disable-Feature /FeatureName:"MicrosoftWindowsPowerShellV2" /NoRestart

# Disable Windows Media Player
Get-WindowsCapability -Online -Name 'Media.WindowsMediaPlayer*' | Remove-WindowsCapability -Online

# Disable IE / IE mode
Get-WindowsCapability -Online -Name 'Browser.InternetExplorer*' | Remove-WindowsCapability -Online
dism /Online /Disable-Feature /FeatureName:"Internet-Explorer-Optional-x64" /NoRestart
dism /Online /Disable-Feature /FeatureName:"Internet-Explorer-Optional-x84" /NoRestart
dism /Online /Disable-Feature /FeatureName:"Internet-Explorer-Optional-amd64" /NoRestart

# Disable the telnet client
dism /Online /Disable-Feature /FeatureName:"TelnetClient" /NoRestart

# Uninstall some "optional apps"
Get-WindowsCapability -Online -Name 'App.Support.QuickAssist*' | Remove-WindowsCapability -Online
Get-WindowsCapability -Online -Name 'App.StepsRecorder*' | Remove-WindowsCapability -Online
Get-WindowsCapability -Online -Name 'Microsoft.Windows.PowerShell.ISE*' | Remove-WindowsCapability -Online
Get-WindowsCapability -Online -Name 'MathRecognizer*' | Remove-WindowsCapability -Online
Get-WindowsCapability -Online -Name 'OpenSSH.Client*' | Remove-WindowsCapability -Online

# Install WSL (Windows Subsystem for Linux, aka Linux in Windows)
wsl --install

# Update Defender signatures before running any scan
Set-MpPreference -CheckForSignaturesBeforeRunningScan 1
Set-MpPreference -EnableNetworkProtection Enabled
Set-MpPreference -PUAProtection Enabled

# Disable Defender saying to sign into a MS account (lol!)
reg add "HKCU\Software\Microsoft\Windows Security Health\State" /v "AccountProtection_MicrosoftAccount_Disconnected" /t REG_DWORD /d 1 /f

# Disable Defender saying to turn on Edge smartscreen filter
reg add "HKCU\Software\Microsoft\Windows Security Health\State" /v "AppAndBrowser_EdgeSmartScreenOff" /t REG_DWORD /d 0 /f

# Disable MS store in "open with"
reg add "HKCU\Software\Policies\Microsoft\Windows\Explorer" /v "NoUseStoreOpenWith" /t REG_DWORD /d 1 /f

# Hide "share" in context menu (From Sophia script)
Remove-Item -Path "Registry::HKEY_CLASSES_ROOT\AllFilesystemObjects\shellex\ContextMenuHandlers\ModernSharing" -Recurse -Force -ErrorAction Ignore
<!-- enable
if (-not (Test-Path -Path "Registry::HKEY_CLASSES_ROOT\AllFilesystemObjects\shellex\ContextMenuHandlers\ModernSharing"))
{
New-Item -Path "Registry::HKEY_CLASSES_ROOT\AllFilesystemObjects\shellex\ContextMenuHandlers\ModernSharing" -Force
}
New-ItemProperty -Path "Registry::HKEY_CLASSES_ROOT\AllFilesystemObjects\shellex\ContextMenuHandlers\ModernSharing" -Name "(default)" -PropertyType String -Value "{e2bf9676-5f8f-435c-97eb-11607a5bedf7}" -Force
-->

## Disable IPv6 (Only disable if you do not have it / ISP does not support it, IPv6 is good!)
#Disable-NetAdapterBinding -Name * -ComponentID ms_tcpip6

# Clean-up system
Clear-RecycleBin -Force -ErrorAction SilentlyContinue
Clear-BCCache -Force -ErrorAction SilentlyContinue
Remove-Item -Force -Confirm:$false -Recurse $env:LocalAppData\Microsoft\Windows\Explorer\*.db
Remove-Item -Force -Confirm:$false $env:localappdata\Temp\*
Remove-Item -Force -Confirm:$false "$env:WINDIR\Temp"
Remove-Item -Force -Confirm:$false "$env:TEMP"
</code></pre>

        <h2><a href="#advanced-system-tweaking">Advanced system tweaking (very much not safe to run unless you know what you're doing)</a></h2>

        <p>If you want minimal breakage, don't run anything here.</p>

        <pre><code class="powershell"># Set even more services to manual or disabled that may not be needed
Stop-Service -Name Spooler -Force
Set-Service -Name Spooler -StartupType Disabled # Printing service
Set-Service -Name PrintNotify -StartupType Disabled # Printing service

Stop-Service -Name WSearch -Force
Set-Service -Name WSearch -StartupType Disabled # Windows Search / indexer

Stop-Service -Name LanmanWorkstation -Force
Set-Service -Name LanmanWorkstation -StartupType Disabled # SMB protocol

Stop-Service -Name iphlpsvc -Force
Set-Service -Name iphlpsvc -StartupType Disabled # IPv6, 6to4, ISATAP, Port Proxy, Teredo and IP-HTTPS

Stop-Service -Name BthAvctpSvc -Force
Set-Service -Name BthAvctpSvc -StartupType Disabled # Bluetooth audio support
Stop-Service -Name BTAGService -Force
Set-Service -Name BTAGService -StartupType Disabled # Bluetooth audio support

Stop-Service -Name bthserv -Force
Set-Service -Name bthserv -StartupType Disabled # Bluetooth support

Stop-Service -Name BDESVC -Force
Set-Service -Name BDESVC -StartupType Disabled # Bitlocker drive

Set-Service -Name MapsBroker -StartupType Disabled # Maps for Windows
Set-Service -Name FrameServer -StartupType Disabled # Camera
Set-Service -Name FrameServerMonitor -StartupType Disabled # Camera
Set-Service -Name seclogon -StartupType Disabled # Secondary Logon
Set-Service -Name RetailDemo -StartupType Disabled # I wonder
Set-Service -Name ScDeviceEnum -StartupType Disabled # Smart cards
Set-Service -Name SCardSvr -StartupType Disabled # Smart cards
Set-Service -Name SCPolicySvc -StartupType Disabled # Smart cards
Set-Service -Name WpcMonSvc -StartupType Disabled # Parental controls
Set-Service -Name DispBrokerDesktopSvc -StartupType Disabled # Wireless displays and display configuration
Set-Service -Name Netlogon -StartupType Disabled # Active Directory
Set-Service -Name StiSvc -StartupType Disabled # Scanners
Set-Service -Name lmhosts -StartupType Disabled # If you aren't part of a connected network of devices on WORKGROUP
Set-Service -Name BITS -StartupType Disabled # Will break background updates, Background Intelligent Transfer Services
Set-Service -Name autotimesvc -StartupType Disabled # Sets times based on mobile networks, safe if you arent on a mobile connection
Set-Service -Name EapHost -StartupType Disabled # For VPNs and and network authentication.
Set-Service -Name NaturalAuthentication -StartupType Disabled # Dynamic lock, any signals for time/network/location/bluetooth and stuff
Set-Service -Name SEMgrSvc -StartupType Disabled # NFC
Set-Service -Name LanmanServer -StartupType Disabled # File and printer sharing stuff
Set-Service -Name XboxGipSvc -StartupType Disabled # Xbox accessories
Set-Service -Name XblAuthManager -StartupType Disabled # Xbox live
Set-Service -Name XblGameSave -StartupType Disabled # Xbox live
Set-Service -Name XboxNetApiSvc -StartupType Disabled # Xbox live
Set-Service -Name WbioSrvc -StartupType Disabled # Biometrics
Set-Service -Name Wcncsvc -StartupType Disabled # WPS support
Set-Service -Name icssvc -StartupType Disabled # Hotspots
Set-Service -Name TapiSrv -StartupType Disabled # Telephony
Set-Service -Name ALG -StartupType Disabled # Internet sharing
Set-Service -Name wbengine -StartupType Disabled # Windows backup
Set-Service -Name MicrosoftEdgeElevationService -StartupType Disabled # Edge updating
Set-Service -Name ShellHWDetection -StartupType Disabled # AutoPlay support
Set-Service -Name Themes -StartupType Disabled # Accessibility theming
Set-Service -Name TabletInputService -StartupType Disabled # Touch keyboard and handwiring and tablet writing
Set-Service -Name TextInputManagementService -StartupType Disabled # Above but they decided to rename the service in modenr versions
Set-Service -Name Wcmsvc -StartupType Disabled # Automatically connects/disconnect on a network and shit
Set-Service -Name SstpSvc -StartupType Disabled # SSTP VPNs
Set-Service -Name RmSvc -StartupType Disabled # Airplane mode and radios
Set-Service -Name RasMan -StartupType Disabled # VPNs and Dial-up
Set-Service -Name PcaSvc -StartupType Disabled # Compability Assistant

# Really strip out every Windows application
Get-AppxPackage "Microsoft.WindowsAlarms" | Remove-AppxPackage
Get-AppxPackage "Microsoft.WindowsNotepad" | Remove-AppxPackage
Get-AppxPackage "Microsoft.ScreenSketch" | Remove-AppxPackage
Get-AppxPackage "Microsoft.MicrosoftEdge.Stable" | Remove-AppxPackage
Get-AppxPackage "Microsoft.Paint" | Remove-AppxPackage
Get-AppxPackage "Microsoft.WindowsCamera" | Remove-AppxPackage
Get-AppxPackage "Microsoft.WindowsCalculator" | Remove-AppxPackage
Get-AppxPackage "Microsoft.MicrosoftStickyNotes" | Remove-AppxPackage
Get-AppxPackage "Microsoft.Windows.Photos" | Remove-AppxPackage
Get-AppxPackage "*Xbox*" | Remove-AppxPackage
Get-AppxPackage "Microsoft.GamingApp" | Remove-AppxPackage
Get-AppxPackage "Microsoft.WindowsStore" | Remove-AppxPackage
Get-AppxPackage "Microsoft.HEVCVideoExtension" | Remove-AppxPackage
Get-AppxPackage "Microsoft.HEIFImageExtension" | Remove-AppxPackage
Get-AppxPackage "Microsoft.RawImageExtension" | Remove-AppxPackage
Get-AppxPackage "Microsoft.VP9VideoExtensions" | Remove-AppxPackage
Get-AppxPackage "Microsoft.WebMediaExtensions" | Remove-AppxPackage
Get-AppxPackage "Microsoft.WebpImageExtension" | Remove-AppxPackage

# Turn off every single unnecessary optional feature
Disable-WindowsOptionalFeature -Online -NoRestart -FeatureName Printing-PrintToPDFServices-Features
Disable-WindowsOptionalFeature -Online -NoRestart -FeatureName Printing-Foundation-InternetPrinting-Client
Disable-WindowsOptionalFeature -Online -NoRestart -FeatureName SmbDirect # Smbv3
Disable-WindowsOptionalFeature -Online -NoRestart -FeatureName Microsoft-RemoteDesktopConnection # RDC
Disable-WindowsOptionalFeature -Online -NoRestart -FeatureName MediaPlayback # Media Player

# Uninstall OneDrive (You will need to update your system)
winget uninstall --exact --purge --force Microsoft.OneDrive
winget uninstall --exact --purge --force Microsoft.DevHome

# Disable UAC
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "ConsentPromptBehaviorAdmin" /t REG_DWORD /d 0 /f
</code></pre>

        <h2><a href="#app-installation">App installation</a></h2>

        <h3><a href="#app-installation_winget">winget</a></h3>
        <pre><code class="powershell"># Manually add winget repository source, as it is bugged. thanks MS
Add-AppxPackage -Path https://cdn.winget.microsoft.com/cache/source.msix
winget upgrade --exact --accept-source-agreements --accept-package-agreements

# The apps i like to install, don't have to do all of them (and you really shouldn't)
winget install --accept-source-agreements --accept-package-agreements Alex313031.Thorium.AVX2 Git.Git Microsoft.VisualStudioCode Discord.Discord Valve.Steam Vendicated.Vencord yt-dlp.yt-dlp Gyan.FFmpeg MusicBee.MusicBee voidtools.Everything GIMP.GIMP KDE.Krita Notion.Notion M2Team.NanaZip PrismLauncher.PrismLauncher BleachBit.BleachBit CPUID.CPU-Z CPUID.HWMonitor qBittorrent.qBittorrent Microsoft.DotNet.DesktopRuntime.8 EpicGames.EpicGamesLauncher GoLang.Go TechPowerUp.GPU-Z EclipseAdoptium.Temurin.21.JDK JetBrains.Toolbox rocksdanister.LivelyWallpaper mpv.net OBSProject.OBSStudio CalcProgrammer1.OpenRGB dotPDN.PaintDotNet Microsoft.PowerToys Python.Python.3.12 Rustlang.Rust.MSVC Microsoft.VCRedist.2015+.x64 Microsoft.VisualStudio.2022.Community AntibodySoftware.WizTree
</code></pre>

        <h3><a href="#app-installation_choco">Chocolatey</a></h3>
        <p>
          <i><a href="https://community.chocolatey.org/">Chocolatey website link</a></i>
        </p>
        <pre><code class="powershell"># Run this command as an administrator
Set-ExecutionPolicy Bypass -Scope Process -Force
[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072
iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
</code></pre>

        <h2><a href="#testing">Testing</a></h2>

        <p>On a fresh installation of Windows 11 Pro 23H2x64_v2 with VMWare & VMWare Tools, with a local account set-up for personal use and the PC restarted:</p>

        <img width="48%" src="/img/articles/windows11/windows11_cpu_initial.png" />
        <img width="48%" src="/img/articles/windows11/windows11_ram_initial.png" />

        <p>With most of the tweaks (WSL/winget/choco not included) and a restart without an internet connection:</p>

        <img width="48%" src="/img/articles/windows11/windows11_cpu_tweaked.png" />
        <img width="48%" src="/img/articles/windows11/windows11_ram_tweaked.png" />

        <p>With EVERYTHING applied, Microsoft Edge disabled on startup and a Windows Update [2024-04 CU W11 23H2 x64(KB5036893)], it goes to:</p>

        <img width="48%" src="/img/articles/windows11/windows11_cpu_everything.png" />
        <img width="48%" src="/img/articles/windows11/windows11_ram_everything.png" />
        <script>
          hljs.initHighlightingOnLoad();
        </script>
      </article>
    </main>
  </body>
</html>
